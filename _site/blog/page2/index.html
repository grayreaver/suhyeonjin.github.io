<!DOCTYPE html>
<html lang="en-us">
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Blog &middot; Way Back Home
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/main.css">
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">

  
  <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_SVG"> </script>
  <script type="text/x-mathjax-config">
MathJax.Hub.Config({ tex2jax: { inlineMath: [ ['$','$'], ["\\(","\\)"] ], processEscapes: true } });
  </script>
  
</head>


  <body>

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <div class="sidebar-personal-info">
      <div class="
      ">
        <a href="https://www.github.com/suhyeonjin">
          <img src="/public/profile.jpeg" alt="profile picture" />
        </a>
      </div>
      <div class="sidebar-personal-info-section">
        <p>Su-Hyeon JIN</p>
      </div>
      
      
      
      <div class="sidebar-personal-info-section">
        <p> Contact Me
        
        
        
        <a href="https://github.com/suhyeonjin">
          <i class="fa fa-github" aria-hidden="true"></i>
        </a>
        
        |
        
        
        
        <a href="https://www.facebook.com/jsh05042">
          <i class="fa fa-facebook" aria-hidden="true"></i>
        </a>
        
        |
        
        
        
        <a href="mailto:jsh05042@gmail.com">
          <i class="fa fa-envelope" aria-hidden="true"></i>
        </a>
        
        
        
        <br>
        <span class="notice">

        Why so serious?
        </span>
        </p>
      </div>
      
    </div>
  </div>

<!-- 사이드 메뉴시작 -->
  <nav class="sidebar-nav">
    
      
      
      

      
      <!-- 사이드바 대분류 -->
      <span class="">
        <a class="sidebar-nav-item " href="/blog/">
          Home
        </a>

        
      </span>

    
      
      
      

      
      <!-- 사이드바 대분류 -->
      <span class="foldable">
        <a class="sidebar-nav-item " href="/">
          Categories
        </a>

        
          
            
            
            
            <!-- 사이드바 카테고리 소분류  -->

              <a class="sidebar-nav-item sidebar-nav-item-sub " href="/blog/categories/#til">
                
                TIL (Today I Learned) -
                  
                  
                  0
              </a>
          
        
          
            
            
            
            <!-- 사이드바 카테고리 소분류  -->

              <a class="sidebar-nav-item sidebar-nav-item-sub " href="/blog/categories/#컴퓨터공학">
                
                컴퓨터공학 -
                  
                  
                  0
              </a>
          
        
          
            
            
            
            <!-- 사이드바 카테고리 소분류  -->

              <a class="sidebar-nav-item sidebar-nav-item-sub " href="/blog/categories/#django">
                
                Django -
                  
                  
                  0
              </a>
          
        
          
            
            
            
            <!-- 사이드바 카테고리 소분류  -->

              <a class="sidebar-nav-item sidebar-nav-item-sub " href="/blog/categories/#python">
                
                python -
                  
                  
                  0
              </a>
          
        
          
            
            
            
            <!-- 사이드바 카테고리 소분류  -->

              <a class="sidebar-nav-item sidebar-nav-item-sub " href="/blog/categories/#javascript">
                
                javascript -
                  
                  
                  0
              </a>
          
        
          
            
            
            
            <!-- 사이드바 카테고리 소분류  -->

              <a class="sidebar-nav-item sidebar-nav-item-sub " href="/blog/categories/#nodejs">
                
                nodejs -
                  
                  
                  0
              </a>
          
        
          
            
            
            
            <!-- 사이드바 카테고리 소분류  -->

              <a class="sidebar-nav-item sidebar-nav-item-sub " href="/blog/categories/#MySQL">
                
                MySQL -
                  
                  
                  0
              </a>
          
        
          
            
            
            
            <!-- 사이드바 카테고리 소분류  -->

              <a class="sidebar-nav-item sidebar-nav-item-sub " href="/blog/categories/#알고리즘-문제풀이">
                
                알고리즘 문제풀이 -
                  
                  
                  0
              </a>
          
        
          
            
            
            
            <!-- 사이드바 카테고리 소분류  -->

              <a class="sidebar-nav-item sidebar-nav-item-sub " href="/blog/categories/#git">
                
                git -
                  
                  
                  0
              </a>
          
        
          
            
            
            
            <!-- 사이드바 카테고리 소분류  -->

              <a class="sidebar-nav-item sidebar-nav-item-sub " href="/blog/categories/#firebase">
                
                firebase -
                  
                  
                  0
              </a>
          
        
          
            
            
            
            <!-- 사이드바 카테고리 소분류  -->

              <a class="sidebar-nav-item sidebar-nav-item-sub " href="/blog/categories/#etc">
                
                etc -
                  
                  
                  1
              </a>
          
        
      </span>

    
      
      
      

      
      <!-- 사이드바 대분류 -->
      <span class="">
        <a class="sidebar-nav-item " href="/about/">
          About
        </a>

        
      </span>

    
      
      
      

      
      <!-- 사이드바 대분류 -->
      <span class="">
        <a class="sidebar-nav-item " href="/search/">
          Search
        </a>

        
      </span>

    


  </nav>
  <div class="sidebar-item template">
    <p>
    Powered by <a href="http://jekyllrb.com">jekyll</a> and <a href="http://codinfox.github.io">codinfox-lanyon</a>
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead nav-down">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="suhyeonjin-github-io">
              <!-- <img class="masthead-logo" src="/public/logo.png"/> -->
              <img class="masthead-logo" src="/assets/images/monkey.jpg"/>

            <small id="blog-title">Way Back Home</small>
            </a>
          </h3>

        </div>
      </div>

      <div class="container content">
        <div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/ctf/2018_sharif/2018/02/15/Sharif-CTF-Client01-75/">
        [2018_Sharif_CTF] Client01(75)
      </a>
    </h1>

    <span class="post-date">15 Feb 2018</span>
     |
    
    <a href="/blog/tags/#forensic" class="post-tag">Forensic</a>
    
    <a href="/blog/tags/#string" class="post-tag">string</a>
    
    

    <article>
      <h2 id="exercise">Exercise</h2>

<blockquote>
  <p>Attached file is the homepage of the client01. He knows the flag.</p>
</blockquote>

<p><img src="/images/2018-02-15-Sharif-CTF-Client01-75/exercise.png" alt="" /></p>
<p align="center">[그림] exercise</p>

<h2 id="solution">Solution</h2>

<p>첨부된, Client01의 홈페이지 내에서 Flag를 찾는 문제. 주어진 파일의 압축을 풀면 아래와 같은 디렉토리 구조를 확인할 수 있다. <code class="highlighter-rouge">ls -al</code>로 살펴볼 경우, 숨김 파일로 처리된 항목이 다수 존재하는 것을 확인.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> jsh05042@Macs-MacBook-Pro  ~/Desktop/CTF/2018_Sharif_CTF/Forensic/75_Client01
 tree ./client01
./client01
├── Desktop
├── Documents
├── Downloads
├── Music
├── Pictures
├── Public
├── Templates
└── Videos

jsh05042@Macs-MacBook-Pro  ~/Desktop/CTF/2018_Sharif_CTF/Forensic/75_Client01
ls <span class="nt">-alr</span> ./client01
total 104
drwxr-xr-x@  2 jsh05042  staff     68  1 21 16:33 Videos
drwxr-xr-x@  2 jsh05042  staff     68  1 21 16:33 Templates
drwxr-xr-x@  2 jsh05042  staff     68  1 21 16:33 Public
drwxr-xr-x@  2 jsh05042  staff     68  1 21 16:33 Pictures
drwxr-xr-x@  2 jsh05042  staff     68  1 21 16:33 Music
drwxr-xr-x@  2 jsh05042  staff     68  1 21 16:33 Downloads
drwxr-xr-x@  2 jsh05042  staff     68  1 21 16:33 Documents
drwxr-xr-x@  2 jsh05042  staff     68  1 21 16:33 Desktop
<span class="nt">-rw-------</span>@  1 jsh05042  staff   7046  1 21 16:44 .xsession-errors.old
<span class="nt">-rw-------</span>@  1 jsh05042  staff   7072  1 24 14:13 .xsession-errors
drwxr-xr-x@  6 jsh05042  staff    204  2 15 19:12 .thunderbird
<span class="nt">-rw-r--r--</span>@  1 jsh05042  staff    675  1 21 16:20 .profile
drwxr-xr-x@  5 jsh05042  staff    170  2 15 19:12 .mozilla
drwxr-xr-x@  4 jsh05042  staff    136  2 15 19:12 .local
drwxr-xr-x@  4 jsh05042  staff    136  2 15 19:12 .gnupg
drwx------@  2 jsh05042  staff     68  1 21 16:33 .gconf
<span class="nt">-rw-r--r--</span>@  1 jsh05042  staff     55  1 21 16:33 .dmrc
drwxr-xr-x@ 12 jsh05042  staff    408  2 15 19:12 .config
drwxr-xr-x@  6 jsh05042  staff    204  2 15 19:12 .cinnamon
drwxr-xr-x@  7 jsh05042  staff    238  2 15 19:11 .cache
<span class="nt">-rw-r--r--</span>@  1 jsh05042  staff   3526  1 21 16:20 .bashrc
<span class="nt">-rw-r--r--</span>@  1 jsh05042  staff    220  1 21 16:20 .bash_logout
<span class="nt">-rw-------</span>@  1 jsh05042  staff     51  1 24 14:09 .Xauthority
<span class="nt">-rw-------</span>@  1 jsh05042  staff    632  1 24 14:09 .ICEauthority
<span class="nt">-rw-r--r--</span>@  1 jsh05042  staff  10244  2 15 19:12 .DS_Store
drwxr-xr-x   6 jsh05042  staff    204  2 15 19:11 ..
drwxr-xr-x@ 27 jsh05042  staff    918  2 15 19:11 <span class="nb">.</span>
</code></pre></div></div>

<p>grep 을 이용해, flag 관련 문자열을 탐색한 결과 일부 파일 내에서 해당 문자열이 존재하는 것을 확인해 볼 수 있었다.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>jsh05042@Macs-MacBook-Pro  ~/Desktop/CTF/2018_Sharif_CTF/Forensic/75_Client01
 <span class="nb">grep</span> <span class="nt">-r</span> <span class="s2">"flag"</span> ./client01
Binary file ./client01/.mozilla/firefox/c3a958fk.default/places.sqlite matches
Binary file ./client01/.mozilla/firefox/c3a958fk.default/secmod.db matches
./client01/.thunderbird/5bd7jhog.default/blocklist-addons.json:        <span class="s2">"why"</span>: <span class="s2">"Certain versions of this add-on contains an executable that is flagged by multiple tools as malware. Newer versions no longer use it."</span>,
Binary file ./client01/.thunderbird/5bd7jhog.default/calendar-data/local.sqlite matches
Binary file ./client01/.thunderbird/5bd7jhog.default/global-messages-db.sqlite matches
./client01/.thunderbird/5bd7jhog.default/ImapMail/imap.gmail.com/[Gmail].msf:  <span class="o">(</span><span class="nv">84</span><span class="o">=</span>references<span class="o">)(</span><span class="nv">85</span><span class="o">=</span>recipients<span class="o">)(</span><span class="nv">86</span><span class="o">=</span>date<span class="o">)(</span><span class="nv">87</span><span class="o">=</span>size<span class="o">)(</span><span class="nv">88</span><span class="o">=</span>flags<span class="o">)(</span><span class="nv">89</span><span class="o">=</span>priority<span class="o">)</span>
./client01/.thunderbird/5bd7jhog.default/ImapMail/imap.gmail.com/[Gmail].sbd/All Mail.msf:  <span class="o">(</span><span class="nv">86</span><span class="o">=</span>date<span class="o">)(</span><span class="nv">87</span><span class="o">=</span>size<span class="o">)(</span><span class="nv">88</span><span class="o">=</span>flags<span class="o">)(</span><span class="nv">89</span><span class="o">=</span>priority<span class="o">)(</span><span class="nv">8A</span><span class="o">=</span>label<span class="o">)(</span><span class="nv">8B</span><span class="o">=</span>statusOfset<span class="o">)</span>
./client01/.thunderbird/5bd7jhog.default/ImapMail/imap.gmail.com/[Gmail].sbd/All Mail.msf:&lt;<span class="o">(</span><span class="nv">93</span><span class="o">=</span>flag<span class="o">)&gt;[</span>3:^9A<span class="o">(</span>^95^93<span class="o">)]</span>
./client01/.thunderbird/5bd7jhog.default/ImapMail/imap.gmail.com/[Gmail].sbd/All Mail.msf:    <span class="o">={</span><span class="s2">"threadCol"</span>:<span class="o">{</span><span class="s2">"visible"</span>:true,<span class="s2">"ordinal"</span>:<span class="s2">"1"</span><span class="o">}</span>,<span class="s2">"flaggedCol"</span>:<span class="o">{</span><span class="s2">"visible"</span>:true,<span class="se">\</span>
./client01/.thunderbird/5bd7jhog.default/ImapMail/imap.gmail.com/[Gmail].sbd/Drafts.msf:  <span class="o">(</span><span class="nv">84</span><span class="o">=</span>references<span class="o">)(</span><span class="nv">85</span><span class="o">=</span>recipients<span class="o">)(</span><span class="nv">86</span><span class="o">=</span>date<span class="o">)(</span><span class="nv">87</span><span class="o">=</span>size<span class="o">)(</span><span class="nv">88</span><span class="o">=</span>flags<span class="o">)(</span><span class="nv">89</span><span class="o">=</span>priority<span class="o">)</span>
./client01/.thunderbird/5bd7jhog.default/ImapMail/imap.gmail.com/[Gmail].sbd/Drafts.msf:    <span class="o">={</span><span class="s2">"threadCol"</span>:<span class="o">{</span><span class="s2">"visible"</span>:true<span class="o">}</span>,<span class="s2">"attachmentCol"</span>:<span class="o">{</span><span class="s2">"visible"</span>:true<span class="o">}</span>,<span class="s2">"flaggedCo</span><span class="se">\</span><span class="s2">
./client01/.thunderbird/5bd7jhog.default/ImapMail/imap.gmail.com/[Gmail].sbd/Important.msf:  (87=size)(88=flags)(89=priority)(8A=label)(8B=statusOfset)(8C=numLines)
./client01/.thunderbird/5bd7jhog.default/ImapMail/imap.gmail.com/[Gmail].sbd/Important.msf:    ={"</span>threadCol<span class="s2">":{"</span>visible<span class="s2">":true,"</span>ordinal<span class="s2">":"</span>1<span class="s2">"},"</span>flaggedCol<span class="s2">":{"</span>visible<span class="s2">":true,</span><span class="se">\</span><span class="s2">
./client01/.thunderbird/5bd7jhog.default/ImapMail/imap.gmail.com/[Gmail].sbd/Sent Mail.msf:  (88=flags)(89=priority)(8A=label)(8B=statusOfset)(8C=numLines)
./client01/.thunderbird/5bd7jhog.default/ImapMail/imap.gmail.com/[Gmail].sbd/Sent Mail.msf:    ={"</span>threadCol<span class="s2">":{"</span>visible<span class="s2">":true},"</span>attachmentCol<span class="s2">":{"</span>visible<span class="s2">":true},"</span>flaggedCo<span class="se">\</span>
./client01/.thunderbird/5bd7jhog.default/ImapMail/imap.gmail.com/[Gmail].sbd/Spam.msf:  <span class="o">(</span><span class="nv">88</span><span class="o">=</span>flags<span class="o">)(</span><span class="nv">89</span><span class="o">=</span>priority<span class="o">)(</span><span class="nv">8A</span><span class="o">=</span>label<span class="o">)(</span><span class="nv">8B</span><span class="o">=</span>statusOfset<span class="o">)(</span><span class="nv">8C</span><span class="o">=</span>numLines<span class="o">)</span>
./client01/.thunderbird/5bd7jhog.default/ImapMail/imap.gmail.com/[Gmail].sbd/Spam.msf:    <span class="o">={</span><span class="s2">"threadCol"</span>:<span class="o">{</span><span class="s2">"visible"</span>:true,<span class="s2">"ordinal"</span>:<span class="s2">"1"</span><span class="o">}</span>,<span class="s2">"flaggedCol"</span>:<span class="o">{</span><span class="s2">"visible"</span>:true,<span class="se">\</span>
./client01/.thunderbird/5bd7jhog.default/ImapMail/imap.gmail.com/[Gmail].sbd/Starred.msf:  <span class="o">(</span><span class="nv">84</span><span class="o">=</span>references<span class="o">)(</span><span class="nv">85</span><span class="o">=</span>recipients<span class="o">)(</span><span class="nv">86</span><span class="o">=</span>date<span class="o">)(</span><span class="nv">87</span><span class="o">=</span>size<span class="o">)(</span><span class="nv">88</span><span class="o">=</span>flags<span class="o">)(</span><span class="nv">89</span><span class="o">=</span>priority<span class="o">)</span>
./client01/.thunderbird/5bd7jhog.default/ImapMail/imap.gmail.com/[Gmail].sbd/Trash:Subject: flag
./client01/.thunderbird/5bd7jhog.default/ImapMail/imap.gmail.com/[Gmail].sbd/Trash.msf:  <span class="o">(</span><span class="nv">84</span><span class="o">=</span>references<span class="o">)(</span><span class="nv">85</span><span class="o">=</span>recipients<span class="o">)(</span><span class="nv">86</span><span class="o">=</span>date<span class="o">)(</span><span class="nv">87</span><span class="o">=</span>size<span class="o">)(</span><span class="nv">88</span><span class="o">=</span>flags<span class="o">)(</span><span class="nv">89</span><span class="o">=</span>priority<span class="o">)</span>
./client01/.thunderbird/5bd7jhog.default/ImapMail/imap.gmail.com/[Gmail].sbd/Trash.msf:  <span class="o">(</span><span class="nv">AA</span><span class="o">=</span>flag<span class="o">)(</span>AB
./client01/.thunderbird/5bd7jhog.default/ImapMail/imap.gmail.com/[Gmail].sbd/Trash.msf:    <span class="o">={</span><span class="s2">"threadCol"</span>:<span class="o">{</span><span class="s2">"visible"</span>:true,<span class="s2">"ordinal"</span>:<span class="s2">"1"</span><span class="o">}</span>,<span class="s2">"flaggedCol"</span>:<span class="o">{</span><span class="s2">"visible"</span>:true,<span class="se">\</span>
./client01/.thunderbird/5bd7jhog.default/ImapMail/imap.gmail.com/Archives.msf:  <span class="o">(</span><span class="nv">84</span><span class="o">=</span>references<span class="o">)(</span><span class="nv">85</span><span class="o">=</span>recipients<span class="o">)(</span><span class="nv">86</span><span class="o">=</span>date<span class="o">)(</span><span class="nv">87</span><span class="o">=</span>size<span class="o">)(</span><span class="nv">88</span><span class="o">=</span>flags<span class="o">)(</span><span class="nv">89</span><span class="o">=</span>priority<span class="o">)</span>
./client01/.thunderbird/5bd7jhog.default/ImapMail/imap.gmail.com/Drafts.msf:  <span class="o">(</span><span class="nv">84</span><span class="o">=</span>references<span class="o">)(</span><span class="nv">85</span><span class="o">=</span>recipients<span class="o">)(</span><span class="nv">86</span><span class="o">=</span>date<span class="o">)(</span><span class="nv">87</span><span class="o">=</span>size<span class="o">)(</span><span class="nv">88</span><span class="o">=</span>flags<span class="o">)(</span><span class="nv">89</span><span class="o">=</span>priority<span class="o">)</span>
./client01/.thunderbird/5bd7jhog.default/ImapMail/imap.gmail.com/INBOX:Subject: flag
./client01/.thunderbird/5bd7jhog.default/ImapMail/imap.gmail.com/INBOX.msf:  <span class="o">(</span><span class="nv">88</span><span class="o">=</span>flags<span class="o">)(</span><span class="nv">89</span><span class="o">=</span>priority<span class="o">)(</span><span class="nv">8A</span><span class="o">=</span>label<span class="o">)(</span><span class="nv">8B</span><span class="o">=</span>statusOfset<span class="o">)(</span><span class="nv">8C</span><span class="o">=</span>numLines<span class="o">)</span>
./client01/.thunderbird/5bd7jhog.default/ImapMail/imap.gmail.com/INBOX.msf:    <span class="o">={</span><span class="s2">"threadCol"</span>:<span class="o">{</span><span class="s2">"visible"</span>:true,<span class="s2">"ordinal"</span>:<span class="s2">"1"</span><span class="o">}</span>,<span class="s2">"flaggedCol"</span>:<span class="o">{</span><span class="s2">"visible"</span>:true,<span class="se">\</span>
./client01/.thunderbird/5bd7jhog.default/ImapMail/imap.gmail.com/Sent.msf:  <span class="o">(</span><span class="nv">84</span><span class="o">=</span>references<span class="o">)(</span><span class="nv">85</span><span class="o">=</span>recipients<span class="o">)(</span><span class="nv">86</span><span class="o">=</span>date<span class="o">)(</span><span class="nv">87</span><span class="o">=</span>size<span class="o">)(</span><span class="nv">88</span><span class="o">=</span>flags<span class="o">)(</span><span class="nv">89</span><span class="o">=</span>priority<span class="o">)</span>
./client01/.thunderbird/5bd7jhog.default/ImapMail/imap.gmail.com/Templates.msf:  <span class="o">(</span><span class="nv">84</span><span class="o">=</span>references<span class="o">)(</span><span class="nv">85</span><span class="o">=</span>recipients<span class="o">)(</span><span class="nv">86</span><span class="o">=</span>date<span class="o">)(</span><span class="nv">87</span><span class="o">=</span>size<span class="o">)(</span><span class="nv">88</span><span class="o">=</span>flags<span class="o">)(</span><span class="nv">89</span><span class="o">=</span>priority<span class="o">)</span>
./client01/.thunderbird/5bd7jhog.default/ImapMail/imap.gmail.com.msf:  <span class="o">(</span><span class="nv">84</span><span class="o">=</span>references<span class="o">)(</span><span class="nv">85</span><span class="o">=</span>recipients<span class="o">)(</span><span class="nv">86</span><span class="o">=</span>date<span class="o">)(</span><span class="nv">87</span><span class="o">=</span>size<span class="o">)(</span><span class="nv">88</span><span class="o">=</span>flags<span class="o">)(</span><span class="nv">89</span><span class="o">=</span>priority<span class="o">)</span>
Binary file ./client01/.thunderbird/5bd7jhog.default/kinto.sqlite matches
./client01/.thunderbird/5bd7jhog.default/Mail/Local Folders/Trash.msf:  <span class="o">(</span><span class="nv">84</span><span class="o">=</span>references<span class="o">)(</span><span class="nv">85</span><span class="o">=</span>recipients<span class="o">)(</span><span class="nv">86</span><span class="o">=</span>date<span class="o">)(</span><span class="nv">87</span><span class="o">=</span>size<span class="o">)(</span><span class="nv">88</span><span class="o">=</span>flags<span class="o">)(</span><span class="nv">89</span><span class="o">=</span>priority<span class="o">)</span>
./client01/.thunderbird/5bd7jhog.default/Mail/Local Folders/Unsent Messages.msf:  <span class="o">(</span><span class="nv">84</span><span class="o">=</span>references<span class="o">)(</span><span class="nv">85</span><span class="o">=</span>recipients<span class="o">)(</span><span class="nv">86</span><span class="o">=</span>date<span class="o">)(</span><span class="nv">87</span><span class="o">=</span>size<span class="o">)(</span><span class="nv">88</span><span class="o">=</span>flags<span class="o">)(</span><span class="nv">89</span><span class="o">=</span>priority<span class="o">)</span>
./client01/.thunderbird/5bd7jhog.default/panacea.dat:  <span class="o">(</span><span class="nv">81</span><span class="o">=</span>ns:msg:db:table:kind:folders<span class="o">)(</span><span class="nv">82</span><span class="o">=</span>key<span class="o">)(</span><span class="nv">83</span><span class="o">=</span>flags<span class="o">)(</span><span class="nv">84</span><span class="o">=</span>totalMsgs<span class="o">)</span>
Binary file ./client01/.thunderbird/5bd7jhog.default/places.sqlite matches
Binary file ./client01/.thunderbird/5bd7jhog.default/secmod.db matches
./client01/.xsession-errors:    <span class="s1">'su'</span>, <span class="o">(</span>bus_name, flags<span class="o">)))</span>
./client01/.xsession-errors.old:    <span class="s1">'su'</span>, <span class="o">(</span>bus_name, flags<span class="o">)))</span>

</code></pre></div></div>

<p>.thunderbird 파일 내에서 e-mail과 관련된 항목에서 해당 flag 문자열이 식별되는 것을 확인할 수 있었다. thunderbird 파일을 살펴본다. <code class="highlighter-rouge">inbox</code> 항목 내에서 flag 라는 제목으로 수신된 email을 확인할 수 있으며, link 를 하나 식별할 수 있다.</p>

<p><img src="/images/2018-02-15-Sharif-CTF-Client01-75/inbox.png" alt="" /></p>
<p align="center"><i>[그림] inbox mail</i></p>

<p>해당 링크 <code class="highlighter-rouge">http://www.filehosting.org/file/details/720884/file</code>로 접속하면, 아래와 같이 download link를 redirect 할 mail을 입력할 수 있다.
<img src="/images/2018-02-15-Sharif-CTF-Client01-75/filedown1.png" alt="" /></p>
<p align="center"><i>[그림] file download1</i></p>

<p>본인의 mail 주소를 넣고, inbox 함을 확인한 결과 file download를 수행할 수 있는 link를 받을 수 있었으며, 해당 파일을 정상적으로 download 할 수 있었다.
<img src="/images/2018-02-15-Sharif-CTF-Client01-75/filedown2.png" alt="" /></p>
<p align="center"><i>[그림] file download2</i></p>

<p>download 받은 파일에 대해 확인해보면, data stream으로 식별되나 hex 값을 통해 signature가 손상된 PNG 파일임을 알 수 있다.
<img src="/images/2018-02-15-Sharif-CTF-Client01-75/file_information.png" alt="" /></p>
<p align="center"><i>[그림] file information</i></p>

<p>올바른 signature 값으로 offset을 수정한 뒤, 해당 이미지를 열어보면 Flag을 식별할 수 있었다. (조금 잘려서 보이지만 식별하는데에는 이상이 없다.)</p>

<p><img src="/images/2018-02-15-Sharif-CTF-Client01-75/fixed.png" alt="" /></p>
<p align="center"><i>[그림] signature fix</i></p>

<p><img src="/images/2018-02-15-Sharif-CTF-Client01-75/flag.png" alt="" /></p>
<p align="center"><i>[그림] flag</i></p>

<p align="right"><strong>SharifCTF{43215f0c5e005d4e557ddfe3f2e57df0}</strong></p>

    <article>
    <div class="post-more">
      
      <a href="/ctf/2018_sharif/2018/02/15/Sharif-CTF-Client01-75/#disqus_thread"> <i class="fa fa-comments" aria-hidden="true"></i>Comment</a>&nbsp;
      
      <a href="/ctf/2018_sharif/2018/02/15/Sharif-CTF-Client01-75/"><i class="fa fa-plus-circle" aria-hidden="true"></i>Read more</a>
    </div>
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/ctf/2018_acebear/2018/02/09/AceBear-CTF-STEg-Challenge-996/">
        [2018_AceBear_CTF] STEg Challenge(996)
      </a>
    </h1>

    <span class="post-date">09 Feb 2018</span>
     |
    
    <a href="/blog/tags/#forensic" class="post-tag">Forensic</a>
    
    <a href="/blog/tags/#misc" class="post-tag">MISC</a>
    
    <a href="/blog/tags/#steganography" class="post-tag">steganography</a>
    
    

    <article>
      <h2 id="exercise">Exercise</h2>

<blockquote>
  <p>Download: Link
Service: nc 35.200.176.244 33338
author: komang4130</p>
</blockquote>

<p><img src="/images/2018-02-09-AceBear-CTF-STEg-Challenge-996/exercise.png" alt="" /></p>
<p align="center"><i>[그림] exercise</i></p>

<h2 id="solution">Solution</h2>

<p>AceBear CTF 에서 나왔던 Forensic/MISC 분야 중, 마지막 풀이 문제. JS 문제랑 마찬가지로 대회 당시에는 해결하지 못했다. 문제 제목에 대해서 조금만 더 고찰을 했었더라면 해결할 수 있었을텐데…</p>

<p>link를 통해, 받은 rar 파일을 압축 해제하면, <code class="highlighter-rouge">flag_enc.png</code> 파일을 하나 확인할 수 있다.</p>

<p><img src="/images/2018-02-09-AceBear-CTF-STEg-Challenge-996/flag_enc.png" alt="" /></p>
<p align="center"><i>[그림] flag_enc.png</i></p>

<p>이미지를 자세히 보면, 좌측 상단에 검정색 pixel 일부를 볼 수 있다. 당연히, pixel을 이용한 steganography 방식의 LSB 로 인식하고 접근했었는데 별짓을 다해도 의미있는 문자열을 확인할 수 없었던게 큰 문제였던 것 같다.</p>

<p>문제를 보면, nc 로 socket 접속할 수 있는 server 가 하나 주어지는데, 접속해보면 아래와 같이 16byte의 data를 받아 base64로  encode 된 data를 receive할 수 있었다.
<img src="/images/2018-02-09-AceBear-CTF-STEg-Challenge-996/data_recieve.png" alt="" /></p>
<p align="center"><i>[그림] encode data</i></p>

<p>decode 하여, 확인해보면 flag_enc와 동일한 이미지인 것을 확인할 수 있는데, 자세히 보면 상단의 pixel 위치가 조금씩 다르다.
<img src="/images/2018-02-09-AceBear-CTF-STEg-Challenge-996/file1.png" alt="" /></p>
<p align="center"><i>[그림] decode data</i></p>

<p>여기서 생각의 전환이 조금 필요했다. server로 부터 어떤 유의미한 데이터를 얻어낼 수 있는가 고민을 하다가 결국, 원점으로 돌아가 flag_enc 로부터 정보를 얻어내려 했던 것이 발목을 잡았다..</p>

<p>결과적으로, 문제 제목에서 알 수 있듯이 <code class="highlighter-rouge">STEg</code>, <code class="highlighter-rouge">flag_enc</code> 라는 문자열에 주목해보자. enc라는 문자열은 무엇인가 encrypt 되었다는 것을 의미한다. 그렇다면, 어떤 로직을 통해 data가 encrypt 되었다는 것인데 pixel과 Image를 Steganography 적용하는 방식에서 사용될 수 있는 항목은 주로 lsb일 것이다.</p>

<p>기존에 알고 있던 lsb 방식은 모두 이용해 보았지만 별 소득은 없었고, 구글을 뒤지다가 Python 과 관련된 도구에서 <code class="highlighter-rouge">Stepic</code>라는 것을 찾을 수 있었다. (Python Steganography 라는 언급만 있었어도…ㅂㄷㅂㄷ)</p>

<p><img src="/images/2018-02-09-AceBear-CTF-STEg-Challenge-996/stepic.png" alt="" /></p>
<p align="center"><i>[그림] stepic stegano</i></p>

<p>연속된 3개의 pixel 에 data를 은닉하는 방식의 lsb 인데, code 그대로 사용해 unhide 할 수 있다. (https://stackoverflow.com/questions/16838341/steganography-in-python-stepic)</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>

<span class="k">def</span> <span class="nf">decode_imdata</span><span class="p">(</span><span class="n">imdata</span><span class="p">):</span>
    <span class="s">'''Given a sequence of pixels, returns an iterator of characters
    encoded in the image'''</span>

    <span class="n">imdata</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">imdata</span><span class="p">)</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">pixels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">imdata</span><span class="o">.</span><span class="nb">next</span><span class="p">()[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">imdata</span><span class="o">.</span><span class="nb">next</span><span class="p">()[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">imdata</span><span class="o">.</span><span class="nb">next</span><span class="p">()[:</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">byte</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">7</span><span class="p">):</span>
            <span class="n">byte</span> <span class="o">|=</span> <span class="n">pixels</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mi">1</span>
            <span class="n">byte</span> <span class="o">&lt;&lt;=</span> <span class="mi">1</span>
        <span class="n">byte</span> <span class="o">|=</span> <span class="n">pixels</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mi">1</span>
        <span class="k">yield</span> <span class="nb">chr</span><span class="p">(</span><span class="n">byte</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pixels</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">break</span>


<span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="nb">open</span><span class="p">(</span><span class="s">'test'</span><span class="p">)</span>
<span class="n">data</span>  <span class="o">=</span> <span class="s">''</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">decode_imdata</span><span class="p">(</span><span class="n">im</span><span class="o">.</span><span class="n">getdata</span><span class="p">()))</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">'hex'</span><span class="p">)</span>
<span class="k">print</span> <span class="n">data</span>
</code></pre></div></div>
<p><br /></p>

<p>위 code로 서버로부터 받은 <code class="highlighter-rouge">encode data</code>와 <code class="highlighter-rouge">flag_enc.png</code>를 unhide 했을 때, 아래와 같은 문자열을 얻을 수 있었다. 무엇인가 복호화가 된다는 사실이 일단 실마리이다.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> jsh05042@Macs-MacBook-Pro  ~/Desktop/CTF/2018_Acebear_CTF/Forensic:MISC/STEg
 python ./steg.py
|vohenrbuq<span class="o">{</span>nxe
</code></pre></div></div>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> jsh05042@Macs-MacBook-Pro  ~/Desktop/CTF/2018_Acebear_CTF/Forensic:MISC/STEg
 python ./steg.py
53:<span class="o">)</span>~&gt;1&amp;v1z4hu
</code></pre></div></div>

<p>굳이, server로부터 encode data를 주는 이유는 무엇일까? 해당 data로부터 알아내야할 것이 있다는 말이다. <code class="highlighter-rouge">flag_enc.png</code>로부터 unhide 했을 때, 별 소득이 없었으므로 해당 결과 값에 영향을 미칠만한 항목을 찾아냈어야 했다. (이 부분에서도 꽤 많은 시간을 쏟았다.)</p>

<p>여러 data 를 server 로 send 하다가, <code class="highlighter-rouge">\x00</code> 로만 16byte를 채워보내고 받은 encode data에 대해서 unhide 한 결과 식별할 수 있는 string(<code class="highlighter-rouge">OMG_YOU_BREAK_IT</code>)을 얻을 수 있었다.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>jsh05042@Macs-MacBook-Pro  ~/Desktop/CTF/2018_Acebear_CTF/Forensic:MISC/STEg
 python <span class="nt">-c</span> “print ‘<span class="se">\x</span>00’<span class="k">*</span>16” | nc localhost 33338 | base64 <span class="nt">-D</span> <span class="o">&gt;</span> tmp.png

jsh05042@Macs-MacBook-Pro  ~/Desktop/CTF/2018_Acebear_CTF/Forensic:MISC/STEg
 python ./steg.py
OMG_YOU_BREAK_IT
</code></pre></div></div>

<p>또 여기서, 삽질했던게 Null로 얻은 문자열 길이는 16byte인데 flag_enc.png 에서 얻은 문자열 길이는 14byte이다.. 기왕 내는거 길이 좀 맞춰서 내지;; 14byte 까지만 각각의 문자열을 xor 할 경우 flag를 확인할 수 있었다;;;</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>

<span class="k">def</span> <span class="nf">decode_imdata</span><span class="p">(</span><span class="n">imdata</span><span class="p">):</span>
    <span class="s">'''Given a sequence of pixels, returns an iterator of characters
    encoded in the image'''</span>

    <span class="n">imdata</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">imdata</span><span class="p">)</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">pixels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">imdata</span><span class="o">.</span><span class="nb">next</span><span class="p">()[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">imdata</span><span class="o">.</span><span class="nb">next</span><span class="p">()[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">imdata</span><span class="o">.</span><span class="nb">next</span><span class="p">()[:</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">byte</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">7</span><span class="p">):</span>
            <span class="n">byte</span> <span class="o">|=</span> <span class="n">pixels</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mi">1</span>
            <span class="n">byte</span> <span class="o">&lt;&lt;=</span> <span class="mi">1</span>
        <span class="n">byte</span> <span class="o">|=</span> <span class="n">pixels</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mi">1</span>
        <span class="k">yield</span> <span class="nb">chr</span><span class="p">(</span><span class="n">byte</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pixels</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">break</span>

<span class="k">def</span> <span class="nf">strxor</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="s">''</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="nb">ord</span><span class="p">(</span><span class="n">y</span><span class="p">))</span> <span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">))</span>


<span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="nb">open</span><span class="p">(</span><span class="s">'flag_enc.png'</span><span class="p">)</span>
<span class="n">data</span>  <span class="o">=</span> <span class="s">''</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">decode_imdata</span><span class="p">(</span><span class="n">im</span><span class="o">.</span><span class="n">getdata</span><span class="p">()))</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">'hex'</span><span class="p">)</span>
<span class="k">print</span> <span class="n">data</span>


<span class="n">im2</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="nb">open</span><span class="p">(</span><span class="s">'tmp.png'</span><span class="p">)</span>
<span class="n">data2</span> <span class="o">=</span> <span class="s">''</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">decode_imdata</span><span class="p">(</span><span class="n">im2</span><span class="o">.</span><span class="n">getdata</span><span class="p">()))</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">'hex'</span><span class="p">)</span>
<span class="k">print</span> <span class="n">data2</span>


<span class="k">print</span> <span class="s">''</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="nb">ord</span><span class="p">(</span><span class="n">y</span><span class="p">))</span> <span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">data2</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>jsh05042@Macs-MacBook-Pro  ~/Desktop/CTF/2018_Acebear_CTF/Forensic:MISC/STEg
 python ./steg.py
53:<span class="o">)</span>~&gt;1&amp;v1z4hu
OMG_YOU_BREAK_IT
zStep1k_st3p1k!!
</code></pre></div></div>

<blockquote>
  <p>솔직히, 맞추라고 낸 문제인가 애매하다.. Forensic이 아니라 그냥 MISC 느낌.. 어거지로 끼워 만든 문제 느낌이 너무 강하고, 쓸데 없는 삽질이 너무 많이 필요했다…;;</p>
</blockquote>

<p align="right"><strong>AceBear{zStep1k_st3p1k!!}</strong></p>

    <article>
    <div class="post-more">
      
      <a href="/ctf/2018_acebear/2018/02/09/AceBear-CTF-STEg-Challenge-996/#disqus_thread"> <i class="fa fa-comments" aria-hidden="true"></i>Comment</a>&nbsp;
      
      <a href="/ctf/2018_acebear/2018/02/09/AceBear-CTF-STEg-Challenge-996/"><i class="fa fa-plus-circle" aria-hidden="true"></i>Read more</a>
    </div>
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/ctf/2018_acebear/2018/02/09/AceBear-CTF-My-idol-975/">
        [2018_AceBear_CTF] My idol(975)
      </a>
    </h1>

    <span class="post-date">09 Feb 2018</span>
     |
    
    <a href="/blog/tags/#forensic" class="post-tag">Forensic</a>
    
    <a href="/blog/tags/#misc" class="post-tag">MISC</a>
    
    <a href="/blog/tags/#qr" class="post-tag">Qr</a>
    
    <a href="/blog/tags/#mp3" class="post-tag">mp3</a>
    
    <a href="/blog/tags/#deepsound" class="post-tag">deepsound</a>
    
    

    <article>
      <h2 id="exercise">Exercise</h2>
<blockquote>
  <p>Challenge Description: Trying to listen and maybe you know his name, and you’ll know one of his secret weapons . Something that he deleted from Michael Hansen may help you get in.
Download: Link
Author: komang4130</p>
</blockquote>

<p><img src="/images/2018-02-09-AceBear-CTF-My-idol-975/exercise.png" alt="" /></p>
<p align="center">[그림] exercise</p>

<h2 id="solution">Solution</h2>

<p>Download link 를 통해 받은 파일을 확인해보면, 하나의 ape 파일을 확인할 수 있다. (<code class="highlighter-rouge">call_him.ape</code>)
<img src="/images/2018-02-09-AceBear-CTF-My-idol-975/exiftool.png" alt="" /></p>
<p align="center">[그림] exiftool - call_him.ape</p>

<p>audio/x-monkeys-audio 형식의 audio 파일이며, 재생이 가능하다. 재생을 해서, 들리는 소리를 들어보면 독백의 대사를 읊는 남자의 목소리를 확인할 수 있는데, 중간에 앨리엇이라는 단어를 듣고 예전에 봤던, <code class="highlighter-rouge">Mr.Robot</code>이라는 미드에 나오는 대사 부분임을 알 수 있었다.</p>

<p>일단, 문제로 주어진 binary가 audio 파일이기 떄문에, 생각해볼 수 있는 접근 방식은 morse, spectrum, steganography, funky file format 정도로 세웠다. morese는 특별한 연관 내용이 보이지 않아 넘겼고, spectrum을 확인했을 때, 아래와 같이 특별히 식별되는 정보는 보이지 않았다.
<img src="/images/2018-02-09-AceBear-CTF-My-idol-975/spectrum.png" alt="" /></p>
<p align="center">[그림] check spectrum</p>

<p>내부적으로 딱히, file format을 가지고 장난을 친 흔적도 안보이고, 엔트로피 확인했을 때, 튀는 구간도 보이지 않게 분포가 일정했다. MP3 openStego를 이용해, hiding 된 Text가 있는지 살펴보았으나 마찬가지로 유의미한 정보는 없었으며 audio와 관련된 Steganography 에 대해 좀 더 찾아볼 필요가 있었다.</p>
<pre><code class="language-Bash"> jsh05042@Macs-MacBook-Pro  ~/Desktop/CTF/2018_Acebear_CTF/Forensic:MISC/My idol
 binwalk ./call_him.ape

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
</code></pre>

<p><img src="/images/2018-02-09-AceBear-CTF-My-idol-975/entrophy.png" alt="" /></p>
<p align="center">[그림] check entropy</p>

<pre><code class="language-cmd">C:\Users\jsh05042\Desktop\MP3Stego_1_1_18\MP3Stego&gt;Decode.exe ./call_him.ape -X
MP3StegoEncoder 1.1.17
See README file for copyright info
Input file = './call_him.ape'  output file = './call_him.ape.pcm'
Will attempt to extract hidden information. Output: ./call_him.ape.txt
Enter a passphrase:
Confirm your passphrase: ******
Enter a passphrase: **********
Confirm your passphrase: **********
the bit stream file ./call_him.ape is a BINARY file
HDR: s=FFF, id=0, l=3, ep=off, br=B, sf=0, pd=1, pr=1, m=2, js=3, c=0, o=0, e=0
alg.=MPEG-2 LSF, layer=III, tot bitrate=112, sfrq=22.1
mode=dual-ch, sblim=32, jsbd=32, ch=2
[Frame    0]Not enough main data to decode frame 0.  Frame discarded.
[Frame    1]Got 24048 bits = 751 slots plus 16
[Frame    2]Got 5336 bits = 166 slots plus 24
[Frame    3]Got 8568 bits = 267 slots plus 24
[Frame    4]Side info bad: block_type == 0 in split block.
</code></pre>

<p>Forensic wiki 에서 audio steganography 항목에 대해서 추가적으로 찾아보다, 아래와 같이 <code class="highlighter-rouge">deepsound</code> 라는 항목에 대해 확인할 수 있었다. Audio 에 데이터를 숨기고, 이를 추출할 수 있는 Windows 용 Steganography 도구라고 명시되어 있는데 해당 도구를 찾아 이용해 보았다.
<img src="/images/2018-02-09-AceBear-CTF-My-idol-975/deepsound.png" alt="" /></p>
<p align="center">[그림] Forensic wiki - deepsound</p>

<p><code class="highlighter-rouge">deepsound</code>를 설치하고, <code class="highlighter-rouge">call_him.ape</code> 파일을 로드하니, 아래와 같이 password 요구 화면을 확인할 수 있었다.
<img src="/images/2018-02-09-AceBear-CTF-My-idol-975/deepsound2.png" alt="" /></p>
<p align="center">[그림] deepsound</p>

<p>Password 에 대해 고민하던 찰나, 풀이자가 워낙 적었는지 hint 로 주어진 항목에, “Can u find his wikia?”라는 문장이 있었고 Elliot의 wiki를 찾아볼 수 있었다. http://mrrobot.wikia.com/wiki/Elliot 에서 내용을 볼 수 있으며, password로 쓰일만한 단서가 무엇인가 찾아보던 중 전화번호를 하나 확인할 수 있었다. <code class="highlighter-rouge">(212) 555-0179</code> –&gt; <code class="highlighter-rouge">2125550179</code>로 password를 주었을 때, deepsound 로부터 hide data 를 식별할 수 있었다.
<img src="/images/2018-02-09-AceBear-CTF-My-idol-975/deepsound4.png" alt="" />
<img src="/images/2018-02-09-AceBear-CTF-My-idol-975/deepsound3.png" alt="" /></p>
<p align="center">[그림] deepsound - hide data &amp; extract data</p>

<p>좀 문제가 풀리는가 했는데, 여기서 또 한번 난관을 맞았다.. extract 한 파일의 data 가 도통 뭔지 식별할 수가 없는 문제였다. 이쯤 되면, Forensic 문제로 치부하기엔 Steganography 하나만 인정 해줄수 있을 것 같다… 아래는 해당 decode extract file. 숫자가 나오는 구간, alphabet이 나오는 구간 이렇게 구분지어지는 것은 확인했으나 무슨 의미를 가지는지 전혀 감을 못잡던 찰나, 주최측에서 새로운 힌트를 게시해뒀더라..
<img src="/images/2018-02-09-AceBear-CTF-My-idol-975/extractfile.png" alt="" />
<img src="/images/2018-02-09-AceBear-CTF-My-idol-975/hint.png" alt="" /></p>
<p align="center">[그림] hint &amp; file data</p>

<p>Base64가 아니며, Image file임을 알 수 있고, length, width를 잘 확인하고, charset, Black &amp; White가 주어져있다. hint를 보고난 뒤, File size를 보니 48620 bytes 이다. “220x220”, “221x221”을 했을 때, 48400 size가 나오는데, 해당 파일 크기와 상당히 유사한 값을 띄는 것을 확인하고는 가로 세로 길이가 220인 Image를 base 로 접근했다.</p>

<p>이어서, 위 <code class="highlighter-rouge">weird</code> 파일 data를 보면, 숫자 구간과 alphabet 구간으로 구분지어진 것을 확인할 수 있는데, <code class="highlighter-rouge">Black &amp; White</code>라는 hint 가 주어졌으므로 offset data 가 숫자일 경우, 알파벳일 경우를 나눠 Black과 White 의 색을 표현하는 code를 짜보았다.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>

<span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span> <span class="s">'RGB'</span><span class="p">,</span> <span class="p">(</span><span class="mi">220</span><span class="p">,</span><span class="mi">220</span><span class="p">),</span> <span class="s">"black"</span><span class="p">)</span>
<span class="n">pixels</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="k">with</span> <span class="nb">open</span> <span class="p">(</span><span class="s">"weird"</span><span class="p">,</span> <span class="s">"r"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">data</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="s">''</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="n">pixels</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="k">if</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">in</span> <span class="s">'0123456789'</span><span class="p">:</span>
                <span class="n">pixels</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">pixels</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>

            <span class="n">k</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span><span class="mi">1</span>

<span class="n">img</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s">"./result.png"</span><span class="p">)</span>
</code></pre></div></div>

<p>몇번 시행착오 겪다가, 올바르게 뽑아낸 결과 파일을 확인해 보면, QR Code 임을 알 수 있으며 아래와 같다.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> jsh05042@Macs-MacBook-Pro  ~/Desktop/CTF/2018_Acebear_CTF/Forensic:MISC/My idol
 python my.py
</code></pre></div></div>
<p><img src="/images/2018-02-09-AceBear-CTF-My-idol-975/qr.png" alt="" /></p>
<p align="center">[그림] result - convert file</p>

<p>qr Code 가 나오는데, 색을 굳이 반전 시키지 않아도 정상인식이 가능하다. 인식을 Mobile app으로 진행했으며, 결과 Flag를 확인할 수 있다.
<img src="/images/2018-02-09-AceBear-CTF-My-idol-975/flag.jpeg" alt="" /></p>
<p align="center">[그림] QR - decode with mobile app</p>

<p align="right"><strong>AceBear{2512_Ng0\`i_nh4\`_r4_d3\`!!!!k0_c00l}</strong></p>

    <article>
    <div class="post-more">
      
      <a href="/ctf/2018_acebear/2018/02/09/AceBear-CTF-My-idol-975/#disqus_thread"> <i class="fa fa-comments" aria-hidden="true"></i>Comment</a>&nbsp;
      
      <a href="/ctf/2018_acebear/2018/02/09/AceBear-CTF-My-idol-975/"><i class="fa fa-plus-circle" aria-hidden="true"></i>Read more</a>
    </div>
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/ctf/2018_acebear/2018/02/09/AceBear-CTF-Memory-951/">
        [2018_AceBear_CTF] Memory (951)
      </a>
    </h1>

    <span class="post-date">09 Feb 2018</span>
     |
    
    <a href="/blog/tags/#forensic" class="post-tag">Forensic</a>
    
    <a href="/blog/tags/#misc" class="post-tag">MISC</a>
    
    <a href="/blog/tags/#memory" class="post-tag">memory</a>
    
    <a href="/blog/tags/#spammer" class="post-tag">spammer</a>
    
    

    <article>
      <h2 id="exercise">Exercise</h2>

<blockquote>
  <p>Download: Link
author: f4k3r</p>
</blockquote>

<p><img src="/images/2018-02-09-AceBear-CTF-Memory-951/exercise.png" alt="" /></p>
<p align="center">[그림] exercise</p>

<h2 id="solution">Solution</h2>

<p>Download link 를 통해 받은 파일을 확인해보면, memory dump raw 파일을 하나 확인할 수 있다. volatility를 이용해, imageinfo를 확인해보면 아래와 같은 imageinfo를 식별할 수 있다. (Windows7)</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>jsh05042@Macs-MacBook-Pro  ~/Desktop/CTF/2018_Acebear_CTF/Forensic:MISC/Memory
 vol <span class="nt">-f</span> ./dump.raw imageinfo
Volatility Foundation Volatility Framework 2.6
INFO    : volatility.debug    : Determining profile based on KDBG search...
WARNING : volatility.debug    : Overlay structure cpuinfo_x86 not present <span class="k">in </span>vtypes
WARNING : volatility.debug    : Overlay structure cpuinfo_x86 not present <span class="k">in </span>vtypes
WARNING : volatility.debug    : Overlay structure cpuinfo_x86 not present <span class="k">in </span>vtypes
          Suggested Profile<span class="o">(</span>s<span class="o">)</span> : Win7SP1x86_23418, Win7SP0x86, Win7SP1x86
                     AS Layer1 : IA32PagedMemoryPae <span class="o">(</span>Kernel AS<span class="o">)</span>
                     AS Layer2 : FileAddressSpace <span class="o">(</span>/Users/Mac/Desktop/CTF/2018_Acebear_CTF/Forensic:MISC/Memory/dump.raw<span class="o">)</span>
                      PAE <span class="nb">type</span> : PAE
                           DTB : 0x185000L
                          KDBG : 0x8292ec28L
          Number of Processors : 1
     Image Type <span class="o">(</span>Service Pack<span class="o">)</span> : 1
                KPCR <span class="k">for </span>CPU 0 : 0x8292fc00L
             KUSER_SHARED_DATA : 0xffdf0000L
           Image date and <span class="nb">time</span> : 2018-01-18 02:45:02 UTC+0000
     Image <span class="nb">local </span>date and <span class="nb">time</span> : 2018-01-18 04:45:02 +0200
</code></pre></div></div>
<p><br /></p>

<p>memory dump에 관련된 문제가 나왔을 때, 나같은 경우에는 가장 먼저 이상 프로세스가 없는지 확인한다. 이후, 이상 프로세스가 식별되는 경우에 해당 프로세스에 대한 덤프, 분석 등을 시도하며 별도로 이상한 프로세스가 식별되지 않을 경우 Command line, Registry, Shellbag 등 부가적인 정보, Network, Filelist 등에 대해 분석하는 식으로 보통 접근하는데 이번에도 앞서 언급한 행위 분석을 하는 과정 중 Filescan 에서 Document directory내에 아래와 같은 파일 목록을 확인할 수 있었다.</p>

<p><img src="/images/2018-02-09-AceBear-CTF-Memory-951/filescan.png" alt="" /></p>
<p align="center">[그림] filescan list</p>

<p>식별되는 <code class="highlighter-rouge">\Device\HarddiskVolume2\Users\Administrator\Documents</code> 내에서 확인되는 파일 목록 중 특이한 부분은 아래와 같다. 5개의 파일이 Document 폴더 내에 존재하는 것을 확인할 수 있는데 각각 rtf 파일 2개, python 파일 1개, gif 파일 1개, pdf 파일 1개이다.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0x000000001e0ed5d0      8      0 R--rwd <span class="se">\D</span>evice<span class="se">\H</span>arddiskVolume2<span class="se">\U</span>sers<span class="se">\A</span>dministrator<span class="se">\D</span>ocuments<span class="se">\d</span>ocument.rtf
0x000000001fcaca30      8      0 R--rwd <span class="se">\D</span>evice<span class="se">\H</span>arddiskVolume2<span class="se">\U</span>sers<span class="se">\A</span>dministrator<span class="se">\D</span>ocuments<span class="se">\u</span>sb_command.rtf
0x000000001fcbc4c8      7      0 R--r-d <span class="se">\D</span>evice<span class="se">\H</span>arddiskVolume2<span class="se">\U</span>sers<span class="se">\A</span>dministrator<span class="se">\D</span>ocuments<span class="se">\G</span>IF.gif
0x000000001fccbf80      8      0 R--rwd <span class="se">\D</span>evice<span class="se">\H</span>arddiskVolume2<span class="se">\U</span>sers<span class="se">\A</span>dministrator<span class="se">\D</span>ocuments<span class="se">\h</span>ackerrank.py
0x000000001ff241d8      8      0 R--rwd <span class="se">\D</span>evice<span class="se">\H</span>arddiskVolume2<span class="se">\U</span>sers<span class="se">\A</span>dministrator<span class="se">\D</span>ocuments<span class="se">\E</span>thical Hacking.pdf
</code></pre></div></div>
<p><br /></p>

<p><code class="highlighter-rouge">dumpfiles</code> command를 이용해, 해당 offset을 가지는 파일들을 추출해내는 작업을 수행함으로써 직접 각각의 파일을 확인할 수 있다. (Python 파일은 명시된 offset 값으로 바로 추출이 되지 않았지만, 문제 푸는데에는 지장이 없었으며 이 또한 MFT Entry offset을 참조하여 추출해낼 수는 있다.)</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10516  vol <span class="nt">-f</span> ./dump.raw <span class="nt">--profile</span><span class="o">=</span>Win7SP1x86_23418 dumpfiles <span class="nt">-Q</span> 0x000000001e0ed5d0 <span class="nt">-D</span> ./
10517  vol <span class="nt">-f</span> ./dump.raw <span class="nt">--profile</span><span class="o">=</span>Win7SP1x86_23418 dumpfiles <span class="nt">-Q</span> 0x000000001fcaca30 <span class="nt">-D</span> ./
10518  vol <span class="nt">-f</span> ./dump.raw <span class="nt">--profile</span><span class="o">=</span>Win7SP1x86_23418 dumpfiles <span class="nt">-Q</span> 0x000000001fcbc4c8 <span class="nt">-D</span> ./
10519  vol <span class="nt">-f</span> ./dump.raw <span class="nt">--profile</span><span class="o">=</span>Win7SP1x86_23418 dumpfiles <span class="nt">-Q</span> 0x000000001fccbf80 <span class="nt">-D</span> ./
10522  vol <span class="nt">-f</span> ./dump.raw <span class="nt">--profile</span><span class="o">=</span>Win7SP1x86_23418 dumpfiles <span class="nt">-Q</span> 0x000000001ff241d8 <span class="nt">-D</span> ./
</code></pre></div></div>
<p><br /></p>

<p>document.rtf 내용은 아래와 같다. mail로 보이는 내용이 기록되어 있음을 알 수 있다. (아래쪽에서 언급하겠지만, 이 document.rtf 내용이 문제를 푸는 실마리였다.)</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Dear Colleague , Your email address has been submitted
to us indicating your interest in our briefing ! If
you are not interested in our publications and wish
to be removed from our lists, simply do NOT respond
and ignore this mail . This mail is being sent in compliance
with Senate bill 2516 , Title 3 , Section 305 . THIS
IS NOT MULTI-LEVEL MARKETING ! Why work for somebody
else when you can become rich in 48 DAYS ! Have you
ever noticed more people than ever are surfing the
web and the baby boomers are more demanding than their
parents . Well, now is your chance to capitalize on
this ! WE will help YOU turn your business into an
E-BUSINESS &amp; decrease perceived waiting time by 180%
! You can begin at absolutely no cost to you . But
don't believe us . Mrs Jones who resides in Rhode Island
tried us and says "I was skeptical but it worked for
me" ! This offer is 100% legal ! So make yourself rich
now by ordering immediately ! Sign up a friend and
you'll get a discount of 50% . Thank-you for your serious
consideration of our offer ! Dear Salaryman ; Thank-you
for your interest in our briefing ! If you no longer
wish to receive our publications simply reply with
a Subject: of "REMOVE" and you will immediately be
removed from our club ! This mail is being sent in
compliance with Senate bill 1627 ; Title 1 ; Section
301 . This is a ligitimate business proposal ! Why
work for somebody else when you can become rich as
few as 48 weeks ! Have you ever noticed more people
than ever are surfing the web plus nearly every commercial
on television has a .com on in it . Well, now is your
chance to capitalize on this . We will help you increase
customer response by 110% and turn your business into
an E-BUSINESS ! You are guaranteed to succeed because
we take all the risk . But don't believe us . Prof
Simpson of Pennsylvania tried us and says "I was skeptical
but it worked for me" ! We assure you that we operate
within all applicable laws . So make yourself rich
now by ordering immediately . Sign up a friend and
you'll get a discount of 80% ! Thanks ! Dear Friend
; This letter was specially selected to be sent to
you ! We will comply with all removal requests ! This
mail is being sent in compliance with Senate bill 1623
; Title 9 ; Section 303 . THIS IS NOT MULTI-LEVEL MARKETING
. Why work for somebody else when you can become rich
within 81 DAYS . Have you ever noticed how many people
you know are on the Internet plus nobody is getting
any younger . Well, now is your chance to capitalize
on this ! We will help you process your orders within
seconds and use credit cards on your website ! You
can begin at absolutely no cost to you . But don't
believe us . Mrs Anderson of Colorado tried us and
says "My only problem now is where to park all my cars"
! This offer is 100% legal ! Do not go to sleep without
ordering ! Sign up a friend and you get half off .
Warmest regards ! Dear Business person , We know you
are interested in receiving cutting-edge info ! If
you no longer wish to receive our publications simply
reply with a Subject: of "REMOVE" and you will immediately
be removed from our club ! This mail is being sent
in compliance with Senate bill 1623 ; Title 5 , Section
308 ! This is NOT unsolicited bulk mail . Why work
for somebody else when you can become rich inside 23
DAYS ! Have you ever noticed nobody is getting any
younger and society seems to be moving faster and faster
. Well, now is your chance to capitalize on this !
WE will help YOU deliver goods right to the customer's
doorstep and use credit cards on your website ! You
are guaranteed to succeed because we take all the risk
. But don't believe us ! Ms Anderson of Montana tried
us and says "Now I'm rich, Rich, RICH" ! We are a BBB
member in good standing ! If not for you then for your
loved ones - act now . Sign up a friend and you'll
get a discount of 80% . Best regards .
</code></pre></div></div>
<p><br /></p>

<p>usb_command.rtf 내용은 아래와 같다. flag format 의 문자열 텍스트가 일부 기록되어 있는 것을 확인하고는, 너무 쉽게 flag를 찾은게 아닌가 생각했지만 역시나 flag는 아니다. 딱히, 문자열 중에 기록된 pcap 파일이 file list 내에 있는가 찾아보았지만 식별되지는 않았고, 그다지 중요하지 않은 데이터였다.</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tshark -r data.pcapng -T fields -e usb.capdata &gt; data2.txt  //trich xuat du lieu goi tin

tshark -r data.pcap -V  // xem can goi tin

tshark -r data.pcap -V | grep “Left”    // xem phan du lieu goi tin

flag[pr355-0nwards-3a10134e]c

flag[pr355_0nwards_3a10134e]

flag[pr355_0nwards_deafcb32]

FLAG{PR#%%_)NWARDS_#A!)!#$E}C


09 f F
0f l L
04 a A
0a g G
2f [ {
13 p P
15 r R
20 3 #
22 5 %
22 5 %
2d - _
27 0 )
11 n N
1a w W
04 a A
15 r R
07 d D
16 s S
2d - _
20 3 #
04 a A
1e 1 !
27 0 )
1e 1 !
20 3 #
21 4 $
08 e E
30 ] }

01
010006 c C
</code></pre></div></div>
<p><br /></p>

<p>GIF 파일은 아래 이미지와 같은데, 여러 장에 기록된 GIF 를 단일 이미지로 분할하여 모두 쭉 살펴보았지만 특별히 건질만한 항목은 없었다.
<img src="/images/2018-02-09-AceBear-CTF-Memory-951/GIF.gif" alt="" /></p>
<p align="center">[그림] GIF.gif</p>

<p>Ethical Hacking.pdf 파일내 분명 flag와 관련된 항목이 있을거라 생각했고, Embedded pdf 에 초점을 맞춰 분석했다. peepdf를 이용해 pdf 분석을 하였으며, 아래 초기 info 를 보더라도 의심되는 항목은 검출되지 않았다. 그럼에도 stream, object를 하나씩 쭉 살펴보았지만 역시 아무것도 도움이 되는 내용은 존재하지 않았다..
<img src="/images/2018-02-09-AceBear-CTF-Memory-951/peepdf.png" alt="" /></p>
<p align="center">[그림] peepdf with Ethical Hacking.pdf</p>

<p>이번 CTF는 HackXore 친구들과 5명 정도 같이했는데 모두 외쿡인 친구들이었다. 내가 살펴본 Task 들에 대해서 알렸고, hint가 주어졌다. steganography라는 힌트가 주어졌으며, 팀원 중 한명이 document.rtf 의 내용이 Spam Message 내에 정보를 은닉시키는 steganography 기술이 적용된 것 같다는 말을 해주었다. <code class="highlighter-rouge">http://www.spammimic.com/decode.shtml</code>에서 spam message 에 대해 decode 작업을 수행할 수 있었으며, decode 결과 url hash 값으로 보여지는 text 를 얻을 수 있었다.
<img src="/images/2018-02-09-AceBear-CTF-Memory-951/spamdecode.png" alt="" /></p>
<p align="center">[그림] spam mimic decode</p>

<p>Decode Message result : <code class="highlighter-rouge">1gwiPCJHiIrnZAwLB9q9ztZKrD9tbq65YnoZzXALnh6c</code></p>
<ul>
  <li>url hash format 으로 보여지는 해당 Decode 값을 가지고 문제를 어떻게 해결해야 생각하던 찰나, Memory dump 내에서 url 목록을 모두 뽑아보기로 했다. bulk extrator 를 이용해, 해당 Memory내에 존재하는 url histogram 등을 뽑으면서 동시에, strings &amp; grep 조합으로 문자열 탐색을 하다가 <code class="highlighter-rouge">form</code>이라는 hint가 나왔고, memory dump 내 url 목록들 중, google drive 문서에서 비슷한 format 을 가지는 형태가 나오는 것을 확인할 수 있었다.
<img src="/images/2018-02-09-AceBear-CTF-Memory-951/url.png" alt="" /></li>
</ul>
<p align="center">[그림] url format</p>

<p>이후, 개인 계정에서 Gdrive 문서들을 하나씩 열어보면서 Form을 확인했고, 아래와 같은 Form을 가지고 있는 것을 확인할 수 있었다.
<img src="/images/2018-02-09-AceBear-CTF-Memory-951/form.png" alt="" />
<img src="/images/2018-02-09-AceBear-CTF-Memory-951/form2.png" alt="" /></p>
<p align="center">[그림] google drive url form</p>

<p>docement, spreadsheet 등의 url parameter에 해당 Decode Message 결과를 대입하던 중, 아래와 같이 <code class="highlighter-rouge">spread sheet format</code>에서 공개된 문서를 열람할 수 있었으며, 해당 스프레드 시트 내에는 Flag가 기록되어 있었다.</p>

<blockquote>
  <p>result url
https://docs.google.com/spreadsheets/d/1gwiPCJHiIrnZAwLB9q9ztZKrD9tbq65YnoZzXALnh6c/edit#gid=0</p>
</blockquote>

<p><img src="/images/2018-02-09-AceBear-CTF-Memory-951/flag.png" alt="" /></p>
<p align="center">[그림] 스프레드시트 flag</p>
<p align="right"><strong>AceBear{y0u_l00k_v3ry_pr3tty!}</strong></p>


    <article>
    <div class="post-more">
      
      <a href="/ctf/2018_acebear/2018/02/09/AceBear-CTF-Memory-951/#disqus_thread"> <i class="fa fa-comments" aria-hidden="true"></i>Comment</a>&nbsp;
      
      <a href="/ctf/2018_acebear/2018/02/09/AceBear-CTF-Memory-951/"><i class="fa fa-plus-circle" aria-hidden="true"></i>Read more</a>
    </div>
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/ctf/2018_acebear/2018/02/09/AceBear-CTF-JS-999/">
        [2018_AceBear_CTF] JS (999)
      </a>
    </h1>

    <span class="post-date">09 Feb 2018</span>
     |
    
    <a href="/blog/tags/#forensic" class="post-tag">Forensic</a>
    
    <a href="/blog/tags/#misc" class="post-tag">MISC</a>
    
    <a href="/blog/tags/#javascript" class="post-tag">javascript</a>
    
    <a href="/blog/tags/#steganography" class="post-tag">steganography</a>
    
    

    <article>
      <h2 id="exercise">Exercise</h2>

<blockquote>
  <p>Challenge Description: Let listen to the best song of this month.
Download: Link
Author: komang4130</p>
</blockquote>

<p><img src="/images/2018-02-09-AceBear-CTF-JS-999/exercise.png" alt="" /></p>
<p align="center">[그림] exercise</p>

<h2 id="solution">Solution</h2>

<p>Forensic/MISC 분야에서 나왔던 문제, 풀이자가 상당히 적고 나도 당시엔 풀지 못한 문제인데.. 너무 어이 없이 해결해서 당황스럽다..</p>

<p>link를 통해서 받은 파일을 확인해보면, mp3 파일을 하나 확인할 수 있다.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> jsh05042@Macs-MacBook-Pro  ~/Desktop/CTF/2018_Acebear_CTF/Forensic:MISC/JS
 file ./Hey_Stranger.mp3
./Hey_Stranger.mp3: Audio file with ID3 version 2.4.0
 jsh05042@Macs-MacBook-Pro  ~/Desktop/CTF/2018_Acebear_CTF/Forensic:MISC/JS
 exiftool ./Hey_Stranger.mp3
ExifTool Version Number         : 10.55
File Name                       : Hey_Stranger.mp3
Directory                       : <span class="nb">.</span>
File Size                       : 4.7 MB
File Modification Date/Time     : 2018:01:27 14:11:55+09:00
File Access Date/Time           : 2018:02:08 21:26:36+09:00
File Inode Change Date/Time     : 2018:01:27 14:13:20+09:00
File Permissions                : rw-r--r--
File Type                       : MP3
File Type Extension             : mp3
MIME Type                       : audio/mpeg
MPEG Audio Version              : 1
Audio Layer                     : 3
Audio Bitrate                   : 128 kbps
Sample Rate                     : 44100
Channel Mode                    : Stereo
MS Stereo                       : Off
Intensity Stereo                : Off
Copyright Flag                  : False
Original Media                  : False
Emphasis                        : None
ID3 Size                        : 1415670
Copyright                       : Vega
Title                           : Người Lạ Ơi
Genre                           : Rap / Hip Hop Việt
Artist                          : Karik, Orange
Album                           :
User Defined Text               : <span class="o">(</span>author<span class="o">)</span> Châu Đăng Khoa
Encoder Settings                : Lavf56.40.101
Picture MIME Type               : image/png
Picture Type                    : Other
Picture Description             : Hey Stranger - Karik - Orange
Picture                         : <span class="o">(</span>Binary data 1415401 bytes, use <span class="nt">-b</span> option to extract<span class="o">)</span>
Duration                        : 0:03:37 <span class="o">(</span>approx<span class="o">)</span>
</code></pre></div></div>
<p><br /></p>

<p>대회 당시, binary가 mp3 파일로 주어졌기 때문에 MP3stego 등을 이용하거나, Spectrum, GoldWave 등으로 Audio Steganography로 접근했었다. 하지만 전혀 관계없다… <code class="highlighter-rouge">binwalk</code>로 파일 내 데이터를 추출하면, 아래와 같이 Thumbnail로 저장되어 있는 이미지 파일을 하나 확인할 수 있다.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> jsh05042@Macs-MacBook-Pro  ~/Desktop/CTF/2018_Acebear_CTF/Forensic:MISC/JS
binwalk ./Hey_Stranger.mp3

DECIMAL       HEXADECIMAL     DESCRIPTION
<span class="nt">--------------------------------------------------------------------------------</span>
259           0x103           PNG image, 1366 x 1000, 8-bit/color RGBA, non-interlaced
300           0x12C           Zlib compressed data, compressed
4103003       0x3E9B5B        lrzip compressed data
</code></pre></div></div>

<p><img src="/images/2018-02-09-AceBear-CTF-JS-999/info.png" alt="" /></p>
<p align="center"><i>[그림] Binwalk information</i></p>

<p>혹시 몰라, 대회 당시엔 해당 png 파일에 대해 추출하고 OpenStego 돌려보고, LSB 확인하고 등의 작업을 많이 수행했었는데 바보 같았던게 문제에서 <code class="highlighter-rouge">JS</code> 라는 단어를 언급하고 있던 점을 전혀 생각하지 않았던 것이다.</p>

<p><code class="highlighter-rouge">javascript</code> image steganography 에 대해서 찾아보니, 바로 관련된 자료가 나왔고.. 해당 thumbnail을 올려 unhide 해보니.. 바로 Flag 확인..(상당히 어이가 없었다.. 풀이자도 2-3팀 정도였던 걸로 기억하는데, 너무 간단한 문제였다..)
<img src="/images/2018-02-09-AceBear-CTF-JS-999/unhide.png" alt="" /></p>
<p align="center"><i>[그림] unhide Thumbnail</i></p>
<p align="right"><strong>AceBear{!!!!!BoA_Luffy_1s_Real!!!!!}</strong></p>

    <article>
    <div class="post-more">
      
      <a href="/ctf/2018_acebear/2018/02/09/AceBear-CTF-JS-999/#disqus_thread"> <i class="fa fa-comments" aria-hidden="true"></i>Comment</a>&nbsp;
      
      <a href="/ctf/2018_acebear/2018/02/09/AceBear-CTF-JS-999/"><i class="fa fa-plus-circle" aria-hidden="true"></i>Read more</a>
    </div>
  </div>
  
</div>

<div class="pagination">
  
    <a class="pagination-item older" href="/blog/page3">Older</a>
  
  
    
      <a class="pagination-item newer" href="/blog/">Newer</a>
    
  
</div>

      </div>
    </div>
    <a href="/search/" class="search">
      <i class="fa fa-search" aria-hidden="true"></i>
      <!-- <img src="/assets/images/search.png"/> -->
    </a>
    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script>
      (function(document) {
        var toggle = document.querySelector('.sidebar-toggle');
        var sidebar = document.querySelector('#sidebar');
        var checkbox = document.querySelector('#sidebar-checkbox');

        document.addEventListener('click', function(e) {
          var target = e.target;

          if (target === toggle) {
            checkbox.checked = !checkbox.checked;
            e.preventDefault();
          } else if (checkbox.checked && !sidebar.contains(target)) {
            /* click outside the sidebar when sidebar is open */
            checkbox.checked = false;
          }
        }, false);
      })(document);
    </script>
    
    <script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-92094009-1', 'auto');
ga('send', 'pageview');
    </script>
    
    <script id="dsq-count-scr" src="//jinshs-blog.disqus.com/count.js" async></script>
  </body>
  
  <script id="dsq-count-scr" src="//jinshs-blog.disqus.com/count.js" async></script>
  

  <script type="text/javascript">
      // Hide Header on on scroll down
    var didScroll;
    var lastScrollTop = 0;
    var delta = 5;
    var navbarHeight = $('.masthead').outerHeight();

    $(window).scroll(function(event){
      didScroll = true;
    });

    setInterval(function() {
      if (didScroll) {
          hasScrolled();
          didScroll = false;
      }
    }, 250);

    function hasScrolled() {
      var st = $(this).scrollTop();

      // Make sure they scroll more than delta
      if(Math.abs(lastScrollTop - st) <= delta)
          return;

      // If they scrolled down and are past the navbar, add class .nav-up.
      // This is necessary so you never see what is "behind" the navbar.
      if (st > lastScrollTop && st > navbarHeight){
          // Scroll Down
          $('.masthead').removeClass('nav-down').addClass('nav-up');
      } else {
          // Scroll Up
          if(st + $(window).height() < $(document).height()) {
              $('.masthead').removeClass('nav-up').addClass('nav-down');
          }
      }

      lastScrollTop = st;
}
  </script>
</html>
